<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Game</title>
	<style>
		#gameCanvas {
			border: 1px solid black;
		}

		button {
			font-size: 20px;
			/* Increase font size */
			padding: 10px 20px;
			/* Add padding to increase button size */
		}
	</style>
</head>

<body>
	<h1><a href="index.html">CREATE AI TO PLAY THIS GAME</a></h1>
	<canvas id="gameCanvas" width="400" height="400"></canvas><br>
	<button onclick="reloadPage()"> RESTART </button>

	<script>

		const moveAmount = 10;
		function reloadPage() {
			location.reload();
		}
		const abs = Math.abs
		const canvas = document.getElementById("gameCanvas");
		const ctx = canvas.getContext("2d");

		const circleRadius = 10;
		let circleX = 170;
		let circleY = circleRadius;
		let dx = 2;
		let dy = 2;

		let leftWall = 0
		let rightWall = canvas.width
		let topWall = 0
		let BotWall = canvas.height

		function Win() {
			alert("YOU WON. YOU LEFT LESS THAN 1% OF THE STARTING FIELD. " + FieldLeft().toString() + "% TO BE EXACT!!!")
			setTimeout(reloadPage, 200)
		}

		function FieldLeft() {
			return 100 * ((rightWall - leftWall) * (BotWall - topWall)) / (canvas.width * canvas.height)
		}

		function Lose() {
			alert("YOU LEFT " + FieldLeft().toString() + "% OF THE FIELD")
			setTimeout(reloadPage, 200)
		}

		function drawCircle() {
			ctx.beginPath();
			ctx.fillStyle = "red";
			ctx.arc(circleX, circleY, circleRadius, 0, 2 * Math.PI);
			ctx.fill();
		}


		function updateCirclePosition() {
			circleX += dx;
			circleY += dy;

			if (isMoving) {
				if (sdy != 0) {
					if (sdy > 0) {
						if (abs(circleX - squareX) < circleRadius) {
							if (circleY - circleRadius < squareY) {
								Lose()
							}
						}
					} else {
						if (abs(circleX - squareX) < circleRadius) {
							if (circleY + circleRadius > squareY) {
								Lose()
							}
						}
					}
				}
				if (sdx != 0) {
					if (sdx > 0) {
						if (abs(circleY - squareY) < circleRadius) {
							if (circleX - circleRadius < squareX) {
								Lose()
							}
						}
					} else {
						if (abs(circleY - squareY) < circleRadius) {
							if (circleX + circleRadius > squareX) {
								Lose()
							}
						}
					}
				}
			}

			if (circleX + circleRadius > rightWall) {
				dx = -abs(dx);
			}
			if (circleX - circleRadius < leftWall) {
				dx = abs(dx)
			}
			if (circleY + circleRadius > BotWall) {
				dy = -abs(dy);
			}
			if (circleY - circleRadius < topWall) {
				dy = abs(dy)
			}

		}







		const squareSize = 10;
		let squareX = 0;
		let squareY = 0;
		let isMoving = false;
		let sdx = 0
		let sdy = 0



		function drawSquare() {
			ctx.fillStyle = "blue";
			ctx.fillRect(squareX, squareY, squareSize, squareSize);
		}

		function isLeft() {
			return squareX <= leftWall
		}

		function isRight() {
			return squareX >= rightWall - squareSize
		}

		function isTop() {
			return squareY <= topWall
		}

		function isBot() {
			return squareY >= BotWall - squareSize
		}

		function Move() {
			squareX += sdx
			squareY += sdy

			// Determine the opposite direction based on the current direction
			let oppositeDirection;
			if (sdx > 0) {
				oppositeDirection = "left";
			} else if (sdx < 0) {
				oppositeDirection = "right";
			} else if (sdy > 0) {
				oppositeDirection = "up";
			} else if (sdy < 0) {
				oppositeDirection = "down";
			}

			switch (oppositeDirection) {
				case "left":
					// Draw line from (squareX, squareY) to (0, squareY)
					ctx.beginPath();
					ctx.moveTo(squareX, squareY);
					ctx.lineTo(leftWall, squareY);
					ctx.stroke();
					break;
				case "right":
					// Draw line from (squareX, squareY) to (canvasWidth, squareY)
					ctx.beginPath();
					ctx.moveTo(squareX, squareY);
					ctx.lineTo(rightWall, squareY);
					ctx.stroke();
					break;
				case "up":
					// Draw line from (squareX, squareY) to (squareX, 0)
					ctx.beginPath();
					ctx.moveTo(squareX, squareY);
					ctx.lineTo(squareX, topWall);
					ctx.stroke();
					break;
				case "down":
					// Draw line from (squareX, squareY) to (squareX, canvasHeight)
					ctx.beginPath();
					ctx.moveTo(squareX, squareY);
					ctx.lineTo(squareX, BotWall);
					ctx.stroke();
					break;
			}
			if (isTop() || isBot() || isRight() || isLeft()) {
				if (sdx != 0) {
					if (circleY < squareY) {
						BotWall = squareY
						squareY -= squareSize
					} else {
						topWall = squareY
					}
				} else {
					if (circleX < squareX) {
						rightWall = squareX
						squareX -= squareSize
					} else {
						leftWall = squareX
					}
				}

				isMoving = false
				sdx = 0
				sdy = 0
				return
			}

			requestAnimationFrame(Move)
		}

		function StartMoving() {
			if (isMoving) {
				return
			}

			isMoving = true

			if (squareX == leftWall) {
				sdx = 5
			} else if (squareX == rightWall - squareSize) {
				sdx = -5
			} else if (squareY == BotWall - squareSize) {
				sdy = -5
			} else {
				sdy = 5
			}

			Move()

		}

		function animate() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			updateCirclePosition();
			drawCircle();
			drawSquare()
			ctx.beginPath();
			ctx.moveTo(leftWall, topWall);
			ctx.lineTo(rightWall, topWall);
			ctx.lineTo(rightWall, BotWall)
			ctx.lineTo(leftWall, BotWall)
			ctx.lineTo(leftWall, topWall)
			ctx.stroke();
			if (FieldLeft() <= 1) {
				Win()
			}
			requestAnimationFrame(animate);
		}

		function U() {
			if (squareX == leftWall || squareX == rightWall - squareSize) {
				squareY -= moveAmount;
			}
		}
		function D() {

			if (squareX == leftWall || squareX == rightWall - squareSize) {
				squareY += moveAmount;
			}
		}
		function L() {

			if (squareY == topWall || squareY == BotWall - squareSize) {
				squareX -= moveAmount;
			}
		}

		function R() {
			if (squareY == topWall || squareY == BotWall - squareSize) {
				squareX += moveAmount;
			}

		}
		document.addEventListener("keydown", function (event) {
			const keyPressed = event.key;

			if (keyPressed === "ArrowUp") {
				if (squareX == leftWall || squareX == rightWall - squareSize) {
					squareY -= moveAmount;
				}
			} else if (keyPressed === "ArrowDown") {
				if (squareX == leftWall || squareX == rightWall - squareSize) {
					squareY += moveAmount;
				}
			} else if (keyPressed === "ArrowLeft") {
				if (squareY == topWall || squareY == BotWall - squareSize) {
					squareX -= moveAmount;
				}
			} else if (keyPressed === "ArrowRight") {
				if (squareY == topWall || squareY == BotWall - squareSize) {
					squareX += moveAmount;
				}
			} else if (keyPressed === "Enter") {
				StartMoving()
			}
			if (isTop()) {
				squareY = topWall
			}
			if (isBot()) {
				squareY = BotWall - squareSize
			}
			if (isRight()) {
				squareX = rightWall - squareSize
			}
			if (isLeft()) {
				squareX = leftWall
			}

			drawSquare();
		});

		animate()
	</script>
	<button onclick="L()">Left</button>
	<button onclick="R()">Right</button>
	<button onclick="U()">Up</button>
	<button onclick="D()">Down</button>
	<button onclick="StartMoving()">Cross</button>


</body>

</html>
